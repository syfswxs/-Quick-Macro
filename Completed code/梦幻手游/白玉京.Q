[General]
SyntaxVersion=2
BeginHotkey=81
BeginHotkeyMod=2
PauseHotkey=87
PauseHotkeyMod=2
StopHotkey=69
StopHotkeyMod=2
RunOnce=1
EnableWindow=
MacroID=eba7fafe-8139-4f6a-9306-401e247e17a8
Description=自动抢购
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]
关注的物品一定不要有已经可以直接购买的物品，如果有，需要先取消关注。即：点击刷新按钮的时候 在我要购买这一栏必须没有任何东西

[Attachment]
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


[Script]
/*
	梦幻西游手游自动抢购系统，最多可输入商城珍品公示期倒计时，自动算出抢购时间并抢购，可抢购完后选择自动关机。
*/
/*
	注意：有坐骑的玩家适用 
*/
//*********************************   源代码   *****************************************
Dim Obj, UserName, NowTime, LenS, Num,aqs
Qbg = false
tuichu = false
zdgj = false//自动关机
//输入时间转整型
intSWTimeM = 0
intSWTimeH = 0
//系统时间转整型
intNowTimeM = 0
intNowTimeH = 0
//记录下架时间转整型
intXJtimeM = 0
//安全锁
aqs = false
//下架
Xj = false
tm1 = 0
th1 = 0
tm2 = 0
th2 = 0
tm3 = 0
th3 = 0
tm4 = 0
th4 = 0
tm5 = 0
th5 = 0
tm6 = 0
th6 = 0
tm7 = 0
th7 = 0
tm8 = 0
th8 = 0
t2 = true
t3 = true
t4 = true
t5 = true
t6 = true
t7 = true
t8 = true
set Obj = createobject("WScript.Shell")
Sub 开始
    //调用“Wscript.Shell”
    UserName=Obj.RegRead("HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\RegisteredOwner")
    // RegRead -- 读取注册表
    YN=Obj.Popup(UserName&" 你好，是否输入目标物品公示期时间进行定时抢购？"&chr (13) &" [是]   ：输入公示期结束时间"&chr (13) &" [否]   ：直接运行抢购程序"&chr (13) &" [取消]：退出程序",0,"白玉京",3)
    //Popup--弹出对话框
    If YN = 6 Then //如果【是】按钮被单击
        获取时间 
        If tuichu = true Then 
            Goto reallyEnd
        End If
        tm1 = intSWTimeM//记录时间的分钟
        th1 = intSWTimeH//记录的小时
        YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：输入公示期结束时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
        If YN = 6 Then //如果【是】按钮被单击
            获取时间 
            If tuichu = true Then 
                Goto reallyEnd
            End If
            tm2 = intSWTimeM//记录时间的分钟
            th2 = intSWTimeH//记录的小时
            t2 = false//已经记录时间
            YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：输入公示期结束时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
            If YN = 6 Then //如果【是】按钮被单击
                获取时间 
                If tuichu = true Then 
                    Goto reallyEnd
                End If
                tm3 = intSWTimeM//记录时间的分钟
                th3 = intSWTimeH//记录的小时
                t3 = false//已经记录时间
                YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：输入公示期结束时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
                If YN = 6 Then //如果【是】按钮被单击
                    获取时间 
                    If tuichu = true Then 
                        Goto reallyEnd
                    End If
                    tm4 = intSWTimeM//记录时间的分钟
                    th4 = intSWTimeH//记录的小时
                    t4 = false//已经记录时间
                    YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：输入公示期结束时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
                    If YN = 6 Then //如果【是】按钮被单击
                        获取时间 
                        If tuichu = true Then 
                            Goto reallyEnd
                        End If
                        tm5 = intSWTimeM//记录时间的分钟
                        th5 = intSWTimeH//记录的小时
                        t5 = false//已经记录时间
                        YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：输入公示期结束时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
                        If YN = 6 Then //如果【是】按钮被单击
                            获取时间 
                            If tuichu = true Then 
                                Goto reallyEnd
                            End If
                            tm6 = intSWTimeM//记录时间的分钟
                            th6 = intSWTimeH//记录的小时
                            t6 = false//已经记录时间
                            YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：输入公示期结束时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
                            If YN = 6 Then //如果【是】按钮被单击
                                获取时间 
                                If tuichu = true Then 
                                    Goto reallyEnd
                                End If
                                tm7 = intSWTimeM//记录时间的分钟
                                th7 = intSWTimeH//记录的小时
                                t7 = false//已经记录时间
                                YN = Obj.Popup("是否添加下一个目标物品公示期时间？" & chr(13) & " [是]   ：设置抢购时间" & chr(13) & " [否]   ：等待系统运行"& chr(13) & "注意：不能输入相差2分钟之内的公示期结束时间，如有请酌情放弃其中一个"& chr(13) & "      否则会出现无法预期的错误", 0, "白玉京", 4)
                                If YN = 6 Then //如果【是】按钮被单击
                                    获取时间 
                                    If tuichu = true Then 
                                        Goto reallyEnd
                                    End If
                                    tm8 = intSWTimeM//记录时间的分钟
                                    th8 = intSWTimeH//记录的小时
                                    t8 = false//已经记录时间
                                    YN = Obj.Popup("已经添加满8个抢购时间，请等待程序运行",3, "白玉京", 0)
                                end if
                            end if
                        end if
                    end if
                end if
            End If
        End If
        是否自动关机
        //*********************************** 对比时间 ****************************************************
        If t2 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        If t3 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        If t4 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分、" & th3 & "时" & tm3 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        If t5 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分、" & th3 & "时" & tm3 & "分、" & th4 & "时" & tm4 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        If t6 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分、" & th3 & "时" & tm3 & "分、" & th4 & "时" & tm4 & "分、" & th5 & "时" & tm5 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        If t7 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分、" & th3 & "时" & tm3 & "分、" & th4 & "时" & tm4 & "分、" & th5 & "时" & tm5 & "分、" & th6 & "时" & tm6 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        If t8 = true Then //如果没记录时间
            Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分、" & th3 & "时" & tm3 & "分、" & th4 & "时" & tm4 & "分、" & th5 & "时" & tm5 & "分、" & th6 & "时" & tm6 & "分、" & th7 & "时" & tm7 & "分抢购！！", 5, "白玉京", 48)
            Goto Start
        End If
        Call Obj.Popup("白玉京系统将在" & th1 & "时" & tm1 & "分、" & th2 & "时" & tm2 & "分、" & th3 & "时" & tm3 & "分、" & th4 & "时" & tm4 & "分、" & th5 & "时" & tm5 & "分、" & th6 & "时" & tm6 & "分、" & th7 & "时" & tm7 & "分、" & th8 & "时" & tm8 & "分抢购！！", 5, "白玉京", 48)
        Rem Start
        If Qbg = true Then 
            Goto 钱不够
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th1 = intNowTimeH and tm1-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm1 = 0//初始化
            th1 = 0
            t1 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th2 = intNowTimeH and tm2-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm2 = 0//初始化
            th2 = 0
            t2 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th3 = intNowTimeH and tm3-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm3 = 0//初始化
            th3 = 0
            t3 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th4 = intNowTimeH and tm4-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm4 = 0//初始化
            th4 = 0
            t4 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th5 = intNowTimeH and tm5-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm5 = 0//初始化
            th5 = 0
            t5 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th6 = intNowTimeH and tm6-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm6 = 0//初始化
            th6 = 0
            t6 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th7 = intNowTimeH and tm7-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm7 = 0//初始化
            th7 = 0
            t7 = True
        End If
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
        If th8 = intNowTimeH and tm8-1 = intNowTimeM Then //如果到了抢购时间的前一分钟
            intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
            Call Obj.Popup("5秒后自动抢购，如在操作请放下鼠标！",5,"白玉京",48)
            Call 抢购
            tm8 = 0//初始化
            th8 = 0
            t8 = True
        End If
        Rem 钱不够
        If Qbg = true Then 
            t1 = true
            t2 = true
            t3 = true
            t4 = true
            t5 = true
            t6 = true
            t7 = true 
            t8 = true
        End If
        If t1 = true and t2 = true and t3 = true and t4 = true and t5 = true and t6 = true and t7 = true and t8 = true Then //如果设定的时间都跑完
            If zdgj = true Then 
                Call Obj.Popup("5秒后自动关机",5,"白玉京",48)
                Obj.Run "shutdown /f /s /t 0"
                //调用shutdown命令。 /f--强行关闭应用程序而不提醒， /s--关闭计算机（要重启的话，请把这改成/r[重启计算机]），/t time--在time秒后前闭计算机。
            End If
            Goto reallyEnd //退出程序
        End if
        For 5//系统每5秒监测一下时间
            FindColor 637,485,883,696,"53A1EB",intX1,intY1//福利刮刮乐
            FindColor 25,163,240,377,"1F42FF",intX2,intY2//福利左侧灯笼
            FindColor 816,111,971,231,"0000C9",intX3,intY3//福利关闭按钮
            If intX1 > 0 And intX2 > 0 and intX3 > 0 Then 
                MoveTo 902, 160
                LeftClick 1//点击关闭12点弹窗
            End If
            Delay 1000
        Next
        Goto Start
    ElseIf YN = 7 Then//如果【否】按钮被点击
        NowTime=Time
        //Time -- 获得当前时间
        intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
        intXJtimeM = intNowTimeM//抢购前记录开始抢购的时间
        Call 抢购//直接抢购
        Goto reallyEnd
    End If
    Rem reallyEnd
    Call Obj.Popup("已退出白玉京系统",5,"白玉京",48)
End Sub
Sub 是否自动关机
    YN = Obj.Popup("抢购最后一个后是否自动关机？", 0, "白玉京", 4)
    If YN = 6 Then 
        zdgj = true
    End If 		
End Sub
Sub 转到商城关注
    FindColor 967,718,1007,755,"3866C0",intX,intY
    If intX > 0 And intY > 0 Then //在战斗中
        Rem 点击展开
        Randomize //初始化随机数生成器。
        x = Int(((40-22)* Rnd) + 22) 
        y = Int(((93-65) * Rnd) + 65)
        MoveTo x, y//移动至展开菜单栏按钮  
        Delay 100
        LeftClick 1//点击进入
        Delay 800
        FindColor 357,48,414,110,"91DDFF",intX,intY
        If intX > 0 And intY > 0 Then //如果展开
            Rem 战斗进商城
            Randomize //初始化随机数生成器。
            x = Int(((63-27)* Rnd) + 27) 
            y = Int(((258-215) * Rnd) + 215)
            MoveTo x, y//移动至商城按钮  
            Delay 500
            LeftClick 1//点击进入
            Delay 800
            FindColor 211, 76, 410, 183, "2A31E1", intXsd, intYsd
            FindColor 896,92,966,174,"0000D0",intXgb,intYgb
            If intXsd > 0 And intXgb > 0 Then 
            Else 
                Goto 战斗进商城
            End If
        Else //没有展开
            Goto 点击展开
        End If
    Else //如果不是在战斗中
        Rem 直接进商城
        Randomize //初始化随机数生成器。
        x = Int(((56-15)* Rnd) + 15) 
        y = Int(((241-204) * Rnd) + 204)
        MoveTo x, y//移动至商城按钮  
        Delay 300
        LeftClick 1	//点击进入
        Delay 800
        FindColor 211, 76, 410, 183, "2A31E1", intXsd, intYsd
        FindColor 896,92,966,174,"0000D0",intXgb,intYgb//出现商城特征
        If intXsd > 0 And intXgb > 0 Then 
        Else 
            Goto 直接进商城
        End If
    End If
    Rem 点击摆摊
    Randomize //初始化随机数生成器。
    x = Int(((986-954)* Rnd) + 954) 
    y = Int(((391-335) * Rnd) + 335)
    MoveTo x, y//移动至摆摊
    Delay 300
    LeftClick 1//点击选中
    Delay 300
    FindColor 919,308,1019,417,"75FEFF",intXbt,intYbt
    If intXbt > 0 And intYbt > 0 Then //摆摊特征出现
        FindColor 47,282,81,349,"CCE3F4",intX,intY
        If intX > 0 And intY > 0 Then //如果本服特征出现
            刷新判断
        Else 
            Randomize //初始化随机数生成器。
            x = Int(((79-49)* Rnd) + 49) 
            y = Int(((344-292) * Rnd) + 292)
            MoveTo x, y//本服
            Delay 500
            LeftClick 1//点击选中
        End If
    Else 
        Goto 点击摆摊
    End If
End Sub
Sub 刷新判断
    intXJtimeM = intXJtimeM + 3//3分钟的刷新时间
    Randomize //初始化随机数生成器。
    x = Int(((246-127)* Rnd) + 127) 
    y = Int(((603-308) * Rnd) + 308)
    MoveTo x, y//移动到左边选项栏
    Rem 关注
    宠物界面取消
    MoveTo 189, 354//向上划选项栏
    LeftDown 1
    Delay 300
    MoveTo 186, 553
    Delay 500
    FindColor 121,296,130,305,"CFE0ED",intX,intY
    If intX > 0 And intY > 0 Then 
    Else 
        LeftUp 1
        Delay 500
        Goto 关注
    End If
    FindColor 210,288,218,300,"CFE0ED",intX,intY
    If intX > 0 And intY > 0 Then 
    Else 
        LeftUp 1
        Delay 500
        Goto 关注
    End If
    FindColor 201,322,212,334,"CFE0ED",intX,intY
    If intX > 0 And intY > 0 Then 
    Else 
        LeftUp 1
        Delay 500
        Goto 关注
    End If
    FindColor 131,320,142,329,"CFE0ED",intX,intY
    If intX > 0 And intY > 0 Then //判断上面几个点是否把菜单栏拉到最上面
    Else 
        LeftUp 1
        Delay 500
        Goto 关注
    End If
    LeftUp 1
    Delay 500
    Randomize //初始化随机数生成器。
    x = Int(((214-135)* Rnd) + 135) 
    y = Int(((341-298) * Rnd) + 298)
    MoveTo x, y//移动到关注按钮
    LeftClick 1//点击
    Delay 800
    Rem 疯狂刷新
    宠物界面取消
    LeftClick 1//点击
    NowTime = Time//获取第一次刷新的当下时间
    intNowTimeM = CInt(Minute(NowTime))
    If intXJtimeM >= 60 Then //如果大于60 则计算正确的分钟
        intXJtimeM = intXJtimeM - 60
    End If
    If intXJtimeM = intNowTimeM Then //如果2分钟后没刷出东西，说明卖家下架
        Xj = true
        Goto 结束刷新
    End If
    rem 监测是否刷出
    FindColor 318,234,362,248,"D3E3F0",intX,intY
    If intX > 0 And intY > 0 Then //如果刷出物品
        Rem 选中物品
        MoveTo 417,268  //选中物品
        Delay 100
        LeftClick 1//点击选中
        Delay 300
        FindColor 389,235,445,258,"6FD6FD",intX,intY
        If intX > 0 And intY > 0 Then //如果已经被选中
            Rem 重复购买
            FindColor 377,244,515,283,"A0C3DF",intX,intY
            If intX > 0 And intY > 0 Then //如果物品不在
                MoveTo 925, 138//点击关闭按钮
                LeftClick 1
                Delay 500
                Goto 结束刷新
            Else //如果物品还存在
                购买
                If Qbg = true Then 
                    Goto 结束刷新
                End If
                Goto 重复购买
            End If
        Else 
            Goto 选中物品
        End If
    Else 
        Goto 疯狂刷新
    End If
    Rem 结束刷新
End Sub
Sub 购买
    Rem 点击购买
    宠物界面取消
    Randomize //初始化随机数生成器。
    x = Int(((887-796)* Rnd) + 796) 
    y = Int(((696-660) * Rnd) + 660)
    MoveTo x, y//移动到购买
    LeftClick 1//点击购买
    Delay 200
    FindColor 214,480,430,566,"63C3EE",intX,intY
    If intX > 0 And intY > 0 Then //如果有购买按钮
        宠物界面取消
		/*MoveTo 488, 287//移动到关闭*/
        Randomize //初始化随机数生成器。
        x = Int(((357-285)* Rnd) + 285) 
        y = Int(((541-506) * Rnd) + 506)
        MoveTo x, y//移动到确认
        LeftClick 1//点击确定
        Delay 300
        宠物界面取消
        FindColor 364, 453, 664, 544, "63C2EF", intqx, intqy
        FindColor 670,267,743,344,"0013C0",intqx1,intqx1
        If intqx > 0 And intqx1 > 0 Then //出现钱不够
            MoveTo 704, 306
            LeftClick 1
            Qbg = true
        End If
    Else 
        Goto 点击购买
    End If
End Sub
Sub 获取时间
    Rem InputTime
    SWTime=InputBox ("请输入公示期倒计时，时间之间冒号必须为英文“:”"&chr (13) &"如：0:16 或 3:35"&chr (13) &"系统已自动提前1分钟抢购，不需要提前预留时间，请如实填写","白玉京")
    //*********************************** 判断时间格式 ****************************************************
    LenS=Len(SWTime)
    //Len--获得字符串的长度
    Num=Instr(SWTime,":")
    //Instr--获得":"所在字符串中的位置
    If Num = 0 Then 
        Num = Instr(SWTime, "：")
        YN = Obj.Popup("你输入的不是时间！", 0, "错误", 5)
        If YN = 4 Then //如果【重试】按钮被单击
            Goto InputTime//跳到 输入时间
        Else 
            tuichu=true
        End If
    End If
    If Num=0 Then
        YN = Obj.Popup("间隔符错误！请用“ : ”或者“ ： ”", 0, "格式错误", 5)
        If YN = 4 Then //如果【重试】按钮被单击
            Goto InputTime//跳到 输入时间
        Else 
            tuichu=true
        End If
    End If
    If left(SWTime,Num-1)>23 or left(SWTime,Num-1)<0  Then
        //left--取字符串左边Num-1个长度的字符
        YN =Obj.Popup("小时格式输入错误！",0,"小时格式错误！",5)
        If YN = 4 Then //如果【重试】按钮被单击
            Goto InputTime//跳到 输入时间
        Else 
            tuichu=true
        End If
    End If
    If Right(SWTime,LenS-Num)>59 or Right(SWTime,LenS-Num)<0 Then
        //Right--取字符串右边LenS-Num个长度的字符
        YN =Obj.Popup("分钟格式输入错误！",0,"分钟格式错误！",5)
        If YN = 4 Then //如果【重试】按钮被单击
            Goto InputTime//跳到 输入时间
        Else 
            tuichu=true
        End If
    End If
    NowTime=Time
    //Time -- 获得当前时间
    intSWTimeM = CInt(Minute(SWTime))//输入的分钟转换成整数型
    intNowTimeM = CInt(Minute(NowTime))//把获取的系统时间分钟转换成整数型
    intSWTimeH = CInt(Hour(SWTime))//输入的小时转换成整数型
    intNowTimeH = CInt(Hour(NowTime))//把获取的系统时间小时转换成整数型
    intSWTimeM = intSWTimeM + intNowTimeM//分钟相加
    If intSWTimeM >= 60 Then //如果输入的分钟加上现在的时间大于60
        intSWTimeH = intSWTimeH + 1
        intSWTimeM = intSWTimeM - 60 
    End If
    intSWTimeH = intSWTimeH + intNowTimeH//小时相加
    If intSWTimeH >= 24 Then //如果输入的小时加上现在的时间大于24
        intSWTimeH = intSWTimeH - 24
    End If
End Sub 
Sub 抢购 
    转到商城关注 
End Sub
Sub 查看安全锁
    FindColor 967,718,1007,755,"3866C0",intX,intY
    if intX > 0 And intY > 0 Then //在战斗中
        Rem 点击展开
        Randomize //初始化随机数生成器。
        x = Int(((40-22)* Rnd) + 22) 
        y = Int(((93-65) * Rnd) + 65)
        MoveTo x, y//移动至展开菜单栏按钮  
        Delay 100
        LeftClick 1//点击进入
        Delay 500
        FindColor 357,48,414,110,"91DDFF",intX,intY
        If intX > 0 And intY > 0 Then //如果展开
            rem 战斗进设置
            Randomize //初始化随机数生成器。
            x = Int(((205-169)* Rnd) + 169) 
            y = Int(((250-212) * Rnd) + 212)
            MoveTo x, y//移动至设置按钮  
            Delay 100
            LeftClick 1//点击进入
            Delay 300
            安全锁
        Else 
            Goto 点击展开
        end if
        FindColor 370,71,385,88,"97E4FF",intX,intY
        If intX > 0 And intY > 0 Then 
            MoveTo intX,intY//移动关闭按钮  
            Delay 100
            LeftClick 1//点击进入
            Delay 300
        End If
    Else //如果没在战斗中
        Rem 进入设置
        FindColor 898,743,916,761,"2022FB",intX,intY
        If intX > 0 And intY > 0 Then //如果下方系统栏展开
            Randomize //初始化随机数生成器。
            x = Int(((585-545)* Rnd) + 545) 
            y = Int(((758-732) * Rnd) + 732)
            MoveTo x, y//移动至下方加号展开按钮  
            Delay 100
            LeftClick 1//点击进入
            Delay 500
            安全锁 
        Else //如果没有展开
            Randomize //初始化随机数生成器。
            x = Int(((1007-977)* Rnd) + 977) 
            y = Int(((765-734) * Rnd) + 734)
            MoveTo x, y//移动至下方加号展开按钮  
            Delay 100
            LeftClick 1//点击进入
            Delay 1000
            Goto 进入设置
        End If
    End If
End Sub
Sub 安全锁
    Randomize //初始化随机数生成器。
    x = Int(((988-947)* Rnd) + 947) 
    y = Int(((512-430) * Rnd) + 430)
    MoveTo x, y//移动至安全锁按钮  
    Delay 100
    LeftClick 1//点击进入
    Delay 800
    FindColor 753,444,778,467,"2956FF",intX,intY
    If intX > 0 And intY > 0 Then //如果安全锁是关闭状态
        aqs = true//安全锁已打开
        Delay 800
        Randomize //初始化随机数生成器。
        x = Int(((949-908)* Rnd) + 908) 
        y = Int(((156-120) * Rnd) + 120)
        MoveTo x, y//移动关闭按钮  
        Delay 100
        LeftClick 1//点击进入
        Delay 300
    End If 
End Sub
Sub 宠物界面取消
    FindColor 156,417,342,484,"60C2EF",intX,intY
    FindColor 361,197,471,300,"4481DB",intX1,intY1
    If intX > 0 And intY1 > 0 Then //如果出现宠物详情界面
        RightClick 1
    End If
End Sub
Sub 主程序
    查看安全锁 
    If aqs = false Then //如果安全锁是锁着的
        Call Obj.Popup("安全锁未打开，请打开安全锁后再执行程序！", 5, "白玉京", 48)
        Goto 结束
    End If
    开始 
    Rem 结束
End Sub
Call 主程序
